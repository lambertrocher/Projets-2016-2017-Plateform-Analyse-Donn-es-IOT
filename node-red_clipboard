[{"id":"bd309609.4cbfd8","type":"tab","label":"Flow 1"},{"id":"9a1fd9e6.572228","type":"http request","z":"bd309609.4cbfd8","name":"show grafana sources","method":"GET","ret":"txt","url":"visualisation:3000/api/datasources","tls":"","x":406.0994338989258,"y":33.59121894836426,"wires":[["fec6f044.cfec"]]},{"id":"fec6f044.cfec","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"false","x":640.9911193847656,"y":20,"wires":[]},{"id":"bd01e958.7b0b68","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":190.9940185546875,"y":41.54198932647705,"wires":[["9a1fd9e6.572228"]]},{"id":"68234a5d.886a24","type":"http request","z":"bd309609.4cbfd8","name":"show grafana sources (second method)","method":"GET","ret":"txt","url":"172.17.0.1:32774/api/datasources","tls":"","x":439.5438766479492,"y":266.2020435333252,"wires":[["50f51538.ff67cc"]]},{"id":"50f51538.ff67cc","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"false","x":719.546688079834,"y":256.4996814727783,"wires":[]},{"id":"7b96ad19.b799c4","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":178.88288116455078,"y":273.81948471069336,"wires":[["68234a5d.886a24"]]},{"id":"350a61dd.a190ce","type":"http request","z":"bd309609.4cbfd8","name":"ping the database","method":"GET","ret":"txt","url":"bd:8086/ping","tls":"","x":386.8607711791992,"y":386.09596157073975,"wires":[["9db3ffbe.a15be","f9628f57.5ddcc"]]},{"id":"34d8a8f3.665c28","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":185.0915412902832,"y":400.53282165527344,"wires":[["350a61dd.a190ce"]]},{"id":"9db3ffbe.a15be","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"payload","x":597.3137245178223,"y":363.9737949371338,"wires":[]},{"id":"f9628f57.5ddcc","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"headers","x":593.9803657531738,"y":410.75157928466797,"wires":[]},{"id":"6469e209.d54abc","type":"http request","z":"bd309609.4cbfd8","name":"create database","method":"POST","ret":"txt","url":"bd:8086/query","tls":"","x":592.9881935119629,"y":522.4569883346558,"wires":[["5aa88088.63bfe","9fe8b983.0948c8"]]},{"id":"ff0dc753.f228e8","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":128.46910095214844,"y":545.1995544433594,"wires":[["825f9e80.5e937"]]},{"id":"5aa88088.63bfe","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"payload","x":800.6634941101074,"y":507.140513420105,"wires":[]},{"id":"9fe8b983.0948c8","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"headers","x":797.3300933837891,"y":552.8072156906128,"wires":[]},{"id":"825f9e80.5e937","type":"function","z":"bd309609.4cbfd8","name":"set parameters of the request","func":"msg.payload = {q:'CREATE DATABASE \"mydb\"'};\nmsg.headers = {'content-type':'application/x-www-form-urlencoded'};\nreturn msg;","outputs":1,"noerr":0,"x":353.7610321044922,"y":536.7074708938599,"wires":[["6469e209.d54abc"]]},{"id":"839342ae.7d2a9","type":"influxdb in","z":"bd309609.4cbfd8","influxdb":"a9917cb9.cf9f9","name":"create db (method 2)","query":"CREATE DATABASE \"mydb2\"","x":397.32598876953125,"y":621.2996711730957,"wires":[["c7429286.a294d","913bdaaf.385478"]]},{"id":"c7429286.a294d","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"false","x":618.5830459594727,"y":606.6121702194214,"wires":[]},{"id":"913bdaaf.385478","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"headers","x":616.0759658813477,"y":656.6050910949707,"wires":[]},{"id":"f85d21e3.30156","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":168.57598876953125,"y":630.0851936340332,"wires":[["839342ae.7d2a9"]]},{"id":"e70f30f9.959db","type":"influxdb in","z":"bd309609.4cbfd8","influxdb":"a9917cb9.cf9f9","name":"show databases","query":"SHOW DATABASES","x":390,"y":734.54541015625,"wires":[["dd8f1799.5dcc68","e502f999.e4cc58"]]},{"id":"dd8f1799.5dcc68","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"false","x":631.2570571899414,"y":719.8579092025757,"wires":[]},{"id":"e502f999.e4cc58","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"headers","x":628.7499771118164,"y":769.850830078125,"wires":[]},{"id":"7c90faf6.43ac84","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":181.25,"y":743.3309326171875,"wires":[["e70f30f9.959db"]]},{"id":"6fe7b455.bedf1c","type":"function","z":"bd309609.4cbfd8","name":"2messages","func":"var msg1 = { payload:\"CREATE DATABASE mydb5\" };\nvar msg2 = { payload:\"CREATE DATABASE mydb6\" };\nreturn [[msg1, msg2]];","outputs":1,"noerr":0,"x":250.7222137451172,"y":949.3610939979553,"wires":[["9054385f.d77338"]]},{"id":"f09ada02.235458","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":113.61111450195312,"y":874.3055429458618,"wires":[["6fe7b455.bedf1c"]]},{"id":"28585ab0.3f8a36","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"payload","x":701,"y":841,"wires":[]},{"id":"a954411b.6d0ff","type":"influxdb in","z":"bd309609.4cbfd8","influxdb":"a9917cb9.cf9f9","name":"create db (method 2)","query":"","x":540.3333358764648,"y":945.222246170044,"wires":[["28585ab0.3f8a36"]]},{"id":"9054385f.d77338","type":"function","z":"bd309609.4cbfd8","name":"set query","func":"msg.query=msg.payload\nreturn msg;","outputs":1,"noerr":0,"x":392.2222328186035,"y":872.2222690582275,"wires":[["a954411b.6d0ff"]]},{"id":"35d1d99b.96a9d6","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":123.33334350585938,"y":1115.5555438995361,"wires":[["edf6f0b3.6087a"]]},{"id":"bd62f9eb.aa8a58","type":"split","z":"bd309609.4cbfd8","name":"","splt":"\\n","x":448.33335876464844,"y":1098.8888673782349,"wires":[["88f3b19a.bf996"]]},{"id":"db4b8f7.7c4067","type":"http request","z":"bd309609.4cbfd8","name":"","method":"GET","ret":"txt","url":"","tls":"","x":638.5,"y":1238,"wires":[["147eee96.2c73e1"]]},{"id":"88f3b19a.bf996","type":"function","z":"bd309609.4cbfd8","name":"Get address","func":"var msg = { payload : msg.payload.address};\nreturn msg;","outputs":1,"noerr":0,"x":601.5,"y":1066,"wires":[["a5d607f0.2000d8"]]},{"id":"651598d6.b61508","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"url","x":795.5,"y":1130,"wires":[]},{"id":"a5d607f0.2000d8","type":"function","z":"bd309609.4cbfd8","name":"Get URL","func":"msg.url = \"http://remote:remote@10.0.2.3/scada-remote?m=json&r=grp&fn=find&alias=\"+msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":593.5,"y":1153,"wires":[["db4b8f7.7c4067","651598d6.b61508"]]},{"id":"edf6f0b3.6087a","type":"http request","z":"bd309609.4cbfd8","name":"","method":"GET","ret":"txt","url":"http://remote:remote@10.0.2.3/scada-remote?m=json&r=objects","tls":"","x":293.5,"y":1124,"wires":[["bd62f9eb.aa8a58"]]},{"id":"147eee96.2c73e1","type":"file","z":"bd309609.4cbfd8","name":"","filename":"/home/data/test.txt","appendNewline":true,"createDir":false,"overwriteFile":"true","x":848.7500152587891,"y":1296.2500190734863,"wires":[]},{"id":"3d99ac52.a17484","type":"function","z":"bd309609.4cbfd8","name":"inject json","func":"var msg = {payload:[\n {\n \"id\": 2308,\n \"address\": \"1/1/4\",\n \"data\": 176,\n \"datatype\": 14,\n \"date\": \"Sun, 25 Dec 2016 20:46:04 +0100\",\n \"comment\": \"\",\n \"name\": \"Puissance générale\",\n \"time\": 1482695164\n },\n {\n \"id\": 2309,\n \"address\": \"1/1/5\",\n \"data\": 1448061,\n \"datatype\": 14,\n \"date\": \"Sun, 25 Dec 2016 20:45:59 +0100\",\n \"comment\": \"\",\n \"name\": \"Energie générale\",\n \"time\": 1482695159\n }]\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":289.3333435058594,"y":1330.3330078125,"wires":[["9aa65f39.40fdc","1ef755fa.1166ea"]]},{"id":"778a7f71.7ffa2","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":127.5,"y":1325,"wires":[["3d99ac52.a17484"]]},{"id":"9aa65f39.40fdc","type":"file","z":"bd309609.4cbfd8","name":"","filename":"/home/data/test.txt","appendNewline":true,"createDir":false,"overwriteFile":"true","x":505.5,"y":1326,"wires":[]},{"id":"1ef755fa.1166ea","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"false","x":440.5,"y":1385,"wires":[]},{"id":"bce35091.06b07","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":118.75,"y":120.00000190734863,"wires":[["21a2c876.fc4208"]]},{"id":"93c4380c.3fd4b8","type":"http request","z":"bd309609.4cbfd8","name":"","method":"GET","ret":"txt","url":"","x":568.7500076293945,"y":130.00000190734863,"wires":[["8c8104ad.2f8208"]]},{"id":"8c8104ad.2f8208","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"false","x":793.7500076293945,"y":123.75000190734863,"wires":[]},{"id":"21a2c876.fc4208","type":"function","z":"bd309609.4cbfd8","name":"","func":"\nreturn msg;","outputs":1,"noerr":0,"x":387.50000524520874,"y":128.75000190734863,"wires":[["93c4380c.3fd4b8"]]},{"id":"8a0a317.c02add","type":"function","z":"bd309609.4cbfd8","name":"multiple measurement points","func":"msg.payload = [\n    {\n        measurement : msg.payload.id,\n        fields: {\n            value : msg.payload.value\n        },\n        tags: {\n            unite: msg.payload.units,\n            name: msg.payload.name\n        },\n        timestamp: msg.payload.updatetime*1000000000\n     },\n     {\n        measurement : msg.payload.id,\n        fields: {\n            value : msg.payload.value\n        },\n        tags: {\n            unite: msg.payload.units,\n            name: msg.payload.name\n        },\n        timestamp: (msg.payload.updatetime+1)*1000000000\n     }\n     ]\n\nreturn msg;\n\n\n/*msg.payload = [\n    {\n        measurement: \"weather_sensor\",\n        fields: {\n            temp: 5.5,\n            light: 678,\n            humidity: 51\n        },\n        tags:{\n            location:\"garden\"\n        },\n        timestamp: new Date()\n    },\n    {\n        measurement: \"alarm_sensor\",\n        fields: {\n            proximity: 999,\n            temp: 19.5\n        },\n        tags:{\n            location:\"home\"\n        },\n        timestamp: new Date()\n    }\n];*/\n","outputs":1,"noerr":0,"x":446,"y":1493,"wires":[["62661ca.fa1ace4","9930931e.0b9ed"]]},{"id":"62661ca.fa1ace4","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"false","x":702.1111450195312,"y":1511.4444580078125,"wires":[]},{"id":"e3236a44.1cfc98","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":144.44444444444443,"y":1504.4444444444443,"wires":[["2501d071.43d63"]]},{"id":"2501d071.43d63","type":"function","z":"bd309609.4cbfd8","name":"inject json","func":"var msg = {payload:\n{\n  \"updatetime\": 1474434001,\n  \"id\": 2049,\n  \"disablelog\": 0,\n  \"tagcache\": \"\",\n  \"data\": 17.47,\n  \"address\": \"1/0/1\",\n  \"datahex\": \"06D3\",\n  \"units\": \" °C\",\n  \"value\": 17.47,\n  \"decoded\": true,\n  \"comment\": \"\",\n  \"name\": \"Température intérieure\",\n  \"datatype\": 9\n}\n}\nreturn msg;","outputs":1,"noerr":0,"x":264.4444580078125,"y":1557.777759552002,"wires":[["8a0a317.c02add"]]},{"id":"9930931e.0b9ed","type":"influxdb batch","z":"bd309609.4cbfd8","influxdb":"bd61ef92.efe67","name":"","x":707.7777671813965,"y":1452.2221240997314,"wires":[]},{"id":"2db314ab.679fcc","type":"influxdb in","z":"bd309609.4cbfd8","influxdb":"a9917cb9.cf9f9","name":"show databases","query":"SELECT* FROM \"coucou\"","x":438,"y":1756,"wires":[["8a4403e7.61dd3","621531d8.e6caa"]]},{"id":"8a4403e7.61dd3","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"false","x":679.2570571899414,"y":1741.3124990463257,"wires":[]},{"id":"621531d8.e6caa","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"headers","x":673.75,"y":1799.305419921875,"wires":[]},{"id":"baf628bd.dc9628","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":229.25,"y":1764.7855224609375,"wires":[["2db314ab.679fcc"]]},{"id":"97657dff.00822","type":"influxdb in","z":"bd309609.4cbfd8","influxdb":"a9917cb9.cf9f9","name":"drop table","query":"DROP MEASUREMENT \"test\"","x":361.89581298828125,"y":1913.1112060546875,"wires":[["46609ea5.d2e07","f91b926b.4da4f"]]},{"id":"46609ea5.d2e07","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"false","x":623.1528701782227,"y":1898.4237051010132,"wires":[]},{"id":"f91b926b.4da4f","type":"debug","z":"bd309609.4cbfd8","name":"","active":true,"console":"false","complete":"headers","x":617.6458129882812,"y":1956.4166259765625,"wires":[]},{"id":"e0037bda.e0dbf8","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":173.14581298828125,"y":1921.896728515625,"wires":[["97657dff.00822"]]},{"id":"d6573c90.d6aaf","type":"inject","z":"bd309609.4cbfd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":252.8958282470703,"y":2051,"wires":[["9f774c20.40847"]]},{"id":"9f774c20.40847","type":"function","z":"bd309609.4cbfd8","name":"Fields and Tags","func":"msg.payload = [{\n    numValue: 15,\n    randomValue: Math.random()*10,\n    strValue: \"message2\",\n    time: 1494434001000000000,\n},\n{\n    tag1:\"sensor1\",\n    tag2:\"device2\"\n}];\nmsg.measurement= \"coucou\";\nreturn msg;","outputs":1,"noerr":0,"x":423.8958282470703,"y":2051,"wires":[["913b1573.2246a8"]]},{"id":"913b1573.2246a8","type":"influxdb out","z":"bd309609.4cbfd8","influxdb":"a9917cb9.cf9f9","name":"","measurement":"","x":601.8958282470703,"y":2051,"wires":[]},{"id":"a9917cb9.cf9f9","type":"influxdb","z":"","hostname":"bd","port":"8086","protocol":"http","database":"mydb","name":"","usetls":false,"tls":""},{"id":"bd61ef92.efe67","type":"influxdb","z":"","hostname":"bd","port":"8086","protocol":"http","database":"mydb","name":"","usetls":false,"tls":""}]
