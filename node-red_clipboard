[{"id":"dac07822.c9f688","type":"tab","label":"Flow 1"},{"id":"c150a2d7.a027f","type":"http request","z":"dac07822.c9f688","name":"show grafana sources","method":"GET","ret":"txt","url":"visualisation:3000/api/datasources","tls":"","x":406.0994338989258,"y":33.59121894836426,"wires":[["b11fb128.b89c8"]]},{"id":"b11fb128.b89c8","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"false","x":640.9911193847656,"y":20,"wires":[]},{"id":"20fbed6c.d411a2","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":190.9940185546875,"y":41.54198932647705,"wires":[["c150a2d7.a027f"]]},{"id":"83f5964f.d78278","type":"http request","z":"dac07822.c9f688","name":"show grafana sources (second method)","method":"GET","ret":"txt","url":"172.17.0.1:32774/api/datasources","tls":"","x":439.5438766479492,"y":266.2020435333252,"wires":[["ef7b9705.b530c8"]]},{"id":"ef7b9705.b530c8","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"false","x":719.546688079834,"y":256.4996814727783,"wires":[]},{"id":"10a83669.37ad1a","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":178.88288116455078,"y":273.81948471069336,"wires":[["83f5964f.d78278"]]},{"id":"e04ec977.e11168","type":"http request","z":"dac07822.c9f688","name":"ping the database","method":"GET","ret":"txt","url":"bd:8086/ping","tls":"","x":386.8607711791992,"y":386.09596157073975,"wires":[["e6066da4.4229b","665010a0.66db5"]]},{"id":"f60b4741.a99968","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":185.0915412902832,"y":400.53282165527344,"wires":[["e04ec977.e11168"]]},{"id":"e6066da4.4229b","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"payload","x":597.3137245178223,"y":363.9737949371338,"wires":[]},{"id":"665010a0.66db5","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"headers","x":593.9803657531738,"y":410.75157928466797,"wires":[]},{"id":"84c9b1fe.f1811","type":"http request","z":"dac07822.c9f688","name":"create database","method":"POST","ret":"txt","url":"bd:8086/query","tls":"","x":592.9881935119629,"y":522.4569883346558,"wires":[["1f40dd44.2da5e3","5ba52b10.d1e684"]]},{"id":"3ffb63bb.4a111c","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":128.46910095214844,"y":545.1995544433594,"wires":[["45651208.9bc20c"]]},{"id":"1f40dd44.2da5e3","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"payload","x":800.6634941101074,"y":507.140513420105,"wires":[]},{"id":"5ba52b10.d1e684","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"headers","x":797.3300933837891,"y":552.8072156906128,"wires":[]},{"id":"45651208.9bc20c","type":"function","z":"dac07822.c9f688","name":"set parameters of the request","func":"msg.payload = {q:'CREATE DATABASE \"mydb\"'};\nmsg.headers = {'content-type':'application/x-www-form-urlencoded'};\nreturn msg;","outputs":1,"noerr":0,"x":353.7610321044922,"y":536.7074708938599,"wires":[["84c9b1fe.f1811"]]},{"id":"da8c301a.19f86","type":"influxdb in","z":"dac07822.c9f688","influxdb":"ad6fb2.e09f505","name":"create db (method 2)","query":"CREATE DATABASE \"mydb2\"","x":397.32598876953125,"y":621.2996711730957,"wires":[["6c5f3bdf.b39f24","a256941c.6a1dc8"]]},{"id":"6c5f3bdf.b39f24","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"false","x":618.5830459594727,"y":606.6121702194214,"wires":[]},{"id":"a256941c.6a1dc8","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"headers","x":616.0759658813477,"y":656.6050910949707,"wires":[]},{"id":"90cc76c4.894218","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":168.57598876953125,"y":630.0851936340332,"wires":[["da8c301a.19f86"]]},{"id":"9dd93069.4f887","type":"influxdb in","z":"dac07822.c9f688","influxdb":"ad6fb2.e09f505","name":"show databases","query":"SHOW DATABASES","x":390,"y":734.54541015625,"wires":[["b7fe4422.f185e8","d7737775.22a408"]]},{"id":"b7fe4422.f185e8","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"false","x":631.2570571899414,"y":719.8579092025757,"wires":[]},{"id":"d7737775.22a408","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"headers","x":628.7499771118164,"y":769.850830078125,"wires":[]},{"id":"e95ab0ca.fe65d","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":181.25,"y":743.3309326171875,"wires":[["9dd93069.4f887"]]},{"id":"28d39e7.4db6962","type":"function","z":"dac07822.c9f688","name":"2messages","func":"var msg1 = { payload:\"CREATE DATABASE mydb5\" };\nvar msg2 = { payload:\"CREATE DATABASE mydb6\" };\nreturn [[msg1, msg2]];","outputs":1,"noerr":0,"x":250.7222137451172,"y":949.3610939979553,"wires":[["3ad99e64.955652"]]},{"id":"80f6e4cb.592958","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":113.61111450195312,"y":874.3055429458618,"wires":[["28d39e7.4db6962"]]},{"id":"e97128da.64c1b8","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"payload","x":701,"y":841,"wires":[]},{"id":"778d27a5.25d008","type":"influxdb in","z":"dac07822.c9f688","influxdb":"ad6fb2.e09f505","name":"create db (method 2)","query":"","x":540.3333358764648,"y":945.222246170044,"wires":[["e97128da.64c1b8"]]},{"id":"3ad99e64.955652","type":"function","z":"dac07822.c9f688","name":"set query","func":"msg.query=msg.payload\nreturn msg;","outputs":1,"noerr":0,"x":392.2222328186035,"y":872.2222690582275,"wires":[["778d27a5.25d008"]]},{"id":"79c7c44c.01428c","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":123.33334350585938,"y":1115.5555438995361,"wires":[["befe4719.5c5a68"]]},{"id":"4e32b920.69b8d8","type":"split","z":"dac07822.c9f688","name":"","splt":"\\n","x":448.33335876464844,"y":1098.8888673782349,"wires":[["87cc6120.1b907"]]},{"id":"4b5efb12.4e70d4","type":"http request","z":"dac07822.c9f688","name":"","method":"GET","ret":"txt","url":"","tls":"","x":638.5,"y":1238,"wires":[["da6bba02.4e1838"]]},{"id":"87cc6120.1b907","type":"function","z":"dac07822.c9f688","name":"Get address","func":"var msg = { payload : msg.payload.address};\nreturn msg;","outputs":1,"noerr":0,"x":601.5,"y":1066,"wires":[["8e59bbf8.349328"]]},{"id":"1a4b8aba.07d8d5","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"url","x":795.5,"y":1130,"wires":[]},{"id":"8e59bbf8.349328","type":"function","z":"dac07822.c9f688","name":"Get URL","func":"msg.url = \"http://remote:remote@10.0.2.3/scada-remote?m=json&r=grp&fn=find&alias=\"+msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":593.5,"y":1153,"wires":[["4b5efb12.4e70d4","1a4b8aba.07d8d5"]]},{"id":"befe4719.5c5a68","type":"http request","z":"dac07822.c9f688","name":"","method":"GET","ret":"txt","url":"http://remote:remote@10.0.2.3/scada-remote?m=json&r=objects","tls":"","x":293.5,"y":1124,"wires":[["4e32b920.69b8d8"]]},{"id":"da6bba02.4e1838","type":"file","z":"dac07822.c9f688","name":"","filename":"/home/data/test.txt","appendNewline":true,"createDir":false,"overwriteFile":"true","x":848.7500152587891,"y":1296.2500190734863,"wires":[]},{"id":"9d95203b.ed505","type":"function","z":"dac07822.c9f688","name":"inject json","func":"var msg = {payload:[\n {\n \"id\": 2308,\n \"address\": \"1/1/4\",\n \"data\": 176,\n \"datatype\": 14,\n \"date\": \"Sun, 25 Dec 2016 20:46:04 +0100\",\n \"comment\": \"\",\n \"name\": \"Puissance générale\",\n \"time\": 1482695164\n },\n {\n \"id\": 2309,\n \"address\": \"1/1/5\",\n \"data\": 1448061,\n \"datatype\": 14,\n \"date\": \"Sun, 25 Dec 2016 20:45:59 +0100\",\n \"comment\": \"\",\n \"name\": \"Energie générale\",\n \"time\": 1482695159\n }]\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":289.3333435058594,"y":1330.3330078125,"wires":[["9c0b9e77.15116","3deb3055.3b306"]]},{"id":"6dc6663b.186638","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":127.5,"y":1325,"wires":[["9d95203b.ed505"]]},{"id":"9c0b9e77.15116","type":"file","z":"dac07822.c9f688","name":"","filename":"/home/data/test.txt","appendNewline":true,"createDir":false,"overwriteFile":"true","x":505.5,"y":1326,"wires":[]},{"id":"3deb3055.3b306","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"false","x":440.5,"y":1385,"wires":[]},{"id":"9d54a259.79867","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":118.75,"y":120.00000190734863,"wires":[["57455e8a.94586"]]},{"id":"9f33195f.2e79f8","type":"http request","z":"dac07822.c9f688","name":"","method":"GET","ret":"txt","url":"","x":568.7500076293945,"y":130.00000190734863,"wires":[["9132135d.3877a"]]},{"id":"9132135d.3877a","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"false","x":793.7500076293945,"y":123.75000190734863,"wires":[]},{"id":"57455e8a.94586","type":"function","z":"dac07822.c9f688","name":"","func":"\nreturn msg;","outputs":1,"noerr":0,"x":387.50000524520874,"y":128.75000190734863,"wires":[["9f33195f.2e79f8"]]},{"id":"acadfdbd.a5676","type":"function","z":"dac07822.c9f688","name":"multiple measurement points","func":"msg.payload = [\n    {\n        measurement : msg.payload.id,\n        fields: {\n            value : msg.payload.value\n        },\n        tags: {\n            unite: msg.payload.units,\n            name: msg.payload.name\n        },\n        timestamp: msg.payload.updatetime\n    }\n    \n    ]\n\nreturn msg;\n\n\n/*msg.payload = [\n    {\n        measurement: \"weather_sensor\",\n        fields: {\n            temp: 5.5,\n            light: 678,\n            humidity: 51\n        },\n        tags:{\n            location:\"garden\"\n        },\n        timestamp: new Date()\n    },\n    {\n        measurement: \"alarm_sensor\",\n        fields: {\n            proximity: 999,\n            temp: 19.5\n        },\n        tags:{\n            location:\"home\"\n        },\n        timestamp: new Date()\n    }\n];*/\n","outputs":1,"noerr":0,"x":446,"y":1493,"wires":[["77a5ef4e.7ab56","5b3bdd94.84bd44"]]},{"id":"77a5ef4e.7ab56","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"false","x":702.1111450195312,"y":1511.4444580078125,"wires":[]},{"id":"39cd518c.f84cfe","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":144.44444444444443,"y":1504.4444444444443,"wires":[["760149fd.afee38"]]},{"id":"760149fd.afee38","type":"function","z":"dac07822.c9f688","name":"inject json","func":"var msg = {payload:\n{\n  \"updatetime\": 1474434001,\n  \"id\": 2049,\n  \"disablelog\": 0,\n  \"tagcache\": \"\",\n  \"data\": 17.47,\n  \"address\": \"1/0/1\",\n  \"datahex\": \"06D3\",\n  \"units\": \" °C\",\n  \"value\": 17.47,\n  \"decoded\": true,\n  \"comment\": \"\",\n  \"name\": \"Température intérieure\",\n  \"datatype\": 9\n}\n}\nreturn msg;","outputs":1,"noerr":0,"x":264.4444580078125,"y":1557.777759552002,"wires":[["acadfdbd.a5676","202a2514.50a50a","ba84e8e8.b5e988","d567dc84.82c8b","1140da9f.0fdd45"]]},{"id":"202a2514.50a50a","type":"debug","z":"dac07822.c9f688","name":"","active":false,"console":"false","complete":"payload.name","x":463.3333396911621,"y":1625.5557012557983,"wires":[]},{"id":"d567dc84.82c8b","type":"debug","z":"dac07822.c9f688","name":"","active":false,"console":"false","complete":"payload.value","x":494.44441986083984,"y":1554.4443311691284,"wires":[]},{"id":"ba84e8e8.b5e988","type":"debug","z":"dac07822.c9f688","name":"","active":false,"console":"false","complete":"payload.units","x":483.3333053588867,"y":1588.8888034820557,"wires":[]},{"id":"1140da9f.0fdd45","type":"debug","z":"dac07822.c9f688","name":"","active":false,"console":"false","complete":"payload.updatetime","x":461.11112213134766,"y":1661.1110677719116,"wires":[]},{"id":"5b3bdd94.84bd44","type":"influxdb batch","z":"dac07822.c9f688","influxdb":"99fe6992.bb4d28","name":"","x":707.7777671813965,"y":1452.2221240997314,"wires":[]},{"id":"1e993469.4e3a2c","type":"influxdb in","z":"dac07822.c9f688","influxdb":"ad6fb2.e09f505","name":"show databases","query":"SELECT \"value\" FROM \"2049\"","x":438,"y":1756,"wires":[["7ba3d4e5.9622ec","7718d9d4.622c78"]]},{"id":"7ba3d4e5.9622ec","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"false","x":679.2570571899414,"y":1741.3124990463257,"wires":[]},{"id":"7718d9d4.622c78","type":"debug","z":"dac07822.c9f688","name":"","active":true,"console":"false","complete":"headers","x":673.75,"y":1799.305419921875,"wires":[]},{"id":"2e58d878.7a8a08","type":"inject","z":"dac07822.c9f688","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":229.25,"y":1764.7855224609375,"wires":[["1e993469.4e3a2c"]]},{"id":"ad6fb2.e09f505","type":"influxdb","z":"","hostname":"bd","port":"8086","protocol":"http","database":"mydb","name":"","usetls":false,"tls":""},{"id":"99fe6992.bb4d28","type":"influxdb","z":"","hostname":"bd","port":"8086","protocol":"http","database":"mydb","name":"","usetls":false,"tls":""}]
